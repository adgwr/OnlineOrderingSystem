<!DOCTYPE html SYSTEM "http://www.thymeleaf.org/dtd/xhtml1-strict-thymeleaf-spring4-4.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">
<html>
<head>
    <meta charset="utf-8"/>
    <title>Register Admin</title>
    <link href="../../admin/css/bootstrap.min.css" rel="stylesheet">
    <link href="../../admin/css/gloab.css" rel="stylesheet">
    <link href="../../admin/css/regUsr.css" rel="stylesheet">
    <script src="../../admin/js/jquery-1.11.1.min.js"></script>
    <script src="../../admin/js/register.js"></script>

    <script type="text/javascript">
        function DateSelector(selYear, selMonth, selDay) {
        this.selYear = selYear;
        this.selMonth = selMonth;
        this.selDay = selDay;
        this.selYear.Group = this;
        this.selMonth.Group = this;
        // 给年份、月份下拉菜单添加处理onchange事件的函数
        if (window.document.all != null) {
            this.selYear.attachEvent("onchange", DateSelector.Onchange);
            this.selMonth.attachEvent("onchange", DateSelector.Onchange);
        } else {
            this.selYear.addEventListener("change", DateSelector.Onchange, false);
            this.selMonth.addEventListener("change", DateSelector.Onchange, false);
        }
        if (arguments.length == 4) {// 如果传入参数个数为4，最后一个参数必须为Date对象
            this.InitSelector(arguments[3].getFullYear(), arguments[3].getMonth() + 1, arguments[3].getDate());
        } else if (arguments.length == 6) {
            //如果传入参数个数为6，最后三个参数必须为初始的年月日数值
            this.InitSelector(arguments[3], arguments[4], arguments[5]);
        } else {
            // 默认使用当前日期
            var dt = new Date();
            this.InitSelector(dt.getFullYear(), dt.getMonth() + 1, dt.getDate());
        }
    }

    // 增加一个最大年份的属性
    DateSelector.prototype.MinYear = 2000;

    // 增加一个最大年份的属性
    DateSelector.prototype.MaxYear = (new Date()).getFullYear();

    // 初始化年份
    DateSelector.prototype.InitYearSelect = function () {
        //循环添加OPION元素到年份select对象中
        for (var i = this.MaxYear; i >= this.MinYear; i--) {
            // 新建一个OPTION对象
            var op = window.document.createElement("OPTION");
            //设置OPTION对象的值
            op.value = i;
            //设置OPTION对象的内容
            op.innerHTML = i;
            //添加到年份select对象
            this.selYear.appendChild(op);
        }
    }

    // 初始化月份
    DateSelector.prototype.InitMonthSelect = function () {// 循环添加OPION元素到月份select对象中
        for (var i = 1; i < 13; i++) {// 新建一个OPTION对象
            var op = window.document.createElement("OPTION");
            //设置OPTION对象的值
            op.value = i;
            //设置OPTION对象的内容
            op.innerHTML = i;
            //添加到月份select对象
            this.selMonth.appendChild(op);
        }
    }

    // 根据年份与月份获取当月的天数
    DateSelector.DaysInMonth = function (year, month) {
        var date = new Date(year, month, 0);
        return date.getDate();
    }

    // 初始化天数
    DateSelector.prototype.InitDaySelect = function () {
        //使用parseInt函数获取当前的年份和月份
        var year = parseInt(this.selYear.value);
        var month = parseInt(this.selMonth.value);
        // 获取当月的天数
        var daysInMonth = DateSelector.DaysInMonth(year, month);
        //清空原有的选项
        this.selDay.options.length = 0;
        //循环添加OPION元素到天数select对象中
        for (var i = 1; i <= daysInMonth; i++) {
            // 新建一个OPTION对象
            var op = window.document.createElement("OPTION");
            //设置OPTION对象的值
            op.value = i;
            //设置OPTION对象的内容
            op.innerHTML = i;
            //添加到天数select对象
            this.selDay.appendChild(op);
        }
    }

    // 处理年份和月份onchange事件的方法，它获取事件来源对象（即selYear或selMonth）
    // 并调用它的Group对象（即DateSelector实例，请见构造函数）提供的InitDaySelect方法重新初始化天数
    //参数e为event对象
    DateSelector.Onchange = function (e) {
        var selector = window.document.all != null ? e.srcElement : e.target;
        selector.Group.InitDaySelect();
    }

    // 根据参数初始化下拉菜单选项
    DateSelector.prototype.InitSelector = function (year, month, day) {
        // 由于外部是可以调用这个方法，因此我们在这里也要将selYear和selMonth的选项清空掉
        // 另外因为InitDaySelect方法已经有清空天数下拉菜单，因此这里就不用重复工作了
        this.selYear.options.length = 0;
        this.selMonth.options.length = 0;
        // 初始化年、月
        this.InitYearSelect();
        this.InitMonthSelect();
        // 设置年、月初始值
        this.selYear.selectedIndex = this.MaxYear - year;
        this.selMonth.selectedIndex = month - 1;
        // 初始化天数
        this.InitDaySelect();
        // 设置天数初始值
        this.selDay.selectedIndex = day - 1;
    }
    </script>
</head>
<body>
<div class="main">
    <div class="main-content">
        <div class="container-fluid">
            <h3 class="page-title">订单管理</h3>
            <div class="row">

                <div class="panel">
                    <div class="panel-heading">
                        <h3 class="panel-title">待接单</h3>
                    </div>
                    <div class="panel-body">
                        <form method="post"
                              action="/receiveOrder">
                            <table class="table">
                                <thead>
                                <tr>
                                    <th></th>
                                    <th>订单ID</th>
                                    <th>用户ID</th>
                                    <th>收货人姓名</th>
                                    <th>收货人地址</th>
                                    <th>收货人电话</th>
                                    <th>订单日期</th>
                                    <th>订单状态</th>
                                    <th>配送方法</th>
                                    <th>订单项</th>
                                </tr>
                                </thead>
                                <tr th:each="paid:${paidList}">
                                    <td width="40"><input type="checkbox" name="paidOrder"
                                                          th:value="${paid.orderID}"></td>
                                    <td th:text="${paid.getOrderID()}"></td>
                                    <td th:text="${paid.getCustomerID()}"></td>
                                    <td th:text="${paid.receiver.getrName()}"></td>
                                    <td th:text="${paid.receiver.getAddress()}"></td>
                                    <td th:text="${paid.receiver.getrTel()}"></td>
                                    <td th:text="${paid.getDate()}"></td>
                                    <td th:text="${paid.getState()}"></td>
                                    <td th:text="${paid.getShipMethod()}"></td>
                                    <td th:text="${paid.getOrderContent()}"></td>
                                </tr>
                            </table>

                            <input type="submit" name="paid_submit" value="接单">

                        </form>
                    </div>
                </div>

                <div class="panel">
                    <div class="panel-heading">
                        <h3 class="panel-title">待配送</h3>
                    </div>
                    <div class="panel-body">
                        <form method="post"
                              action="deliverOrder">
                            <table class="table">
                                <thead>
                                <tr>
                                    <th></th>
                                    <th>订单ID</th>
                                    <th>用户ID</th>
                                    <th>收货人姓名</th>
                                    <th>收货人地址</th>
                                    <th>收货人电话</th>
                                    <th>订单日期</th>
                                    <th>订单状态</th>
                                    <th>配送方法</th>
                                    <th>订单项</th>
                                </tr>
                                </thead>
                                <tr th:each="receive:${receivedList}">
                                    <td width="40"><input type="checkbox" name="receiveOrder"
                                                          th:value="${receive.getOrderID()}"></td>
                                    <td th:text="${receive.getOrderID()}"></td>
                                    <td th:text="${receive.getCustomerID()}"></td>
                                    <td th:text="${receive.receiver.getrName()}"></td>
                                    <td th:text="${receive.receiver.getAddress()}"></td>
                                    <td th:text="${receive.receiver.getrTel()}"></td>
                                    <td th:text="${receive.getDate()}"></td>
                                    <td th:text="${receive.getState()}"></td>
                                    <td th:text="${receive.getShipMethod()}"></td>
                                    <td th:text="${receive.getOrderContent()}"></td>
                                </tr>
                            </table>
                            <input type="submit" name="receive_submit" value="配送">

                        </form>
                    </div>
                </div>

                <div class="panel">
                    <div class="panel-heading">
                        <h3 class="panel-title">配送中</h3>
                    </div>
                    <div class="panel-body">

                        <table class="table">
                            <thead>
                            <tr>
                                <th>订单ID</th>
                                <th>用户ID</th>
                                <th>收货人姓名</th>
                                <th>收货人地址</th>
                                <th>收货人电话</th>
                                <th>订单日期</th>
                                <th>订单状态</th>
                                <th>配送方法</th>
                                <th>订单项</th>
                            </tr>
                            </thead>
                            <tr th:each="delivering:${deliveringList}">
                                <td th:text="${delivering.getOrderID()}"></td>
                                <td th:text="${delivering.getCustomerID()}"></td>
                                <td th:text="${delivering.receiver.getrName()}"></td>
                                <td th:text="${delivering.receiver.getAddress()}"></td>
                                <td th:text="${delivering.receiver.getrTel()}"></td>
                                <td th:text="${delivering.getDate()}"></td>
                                <td th:text="${delivering.getState()}"></td>
                                <td th:text="${delivering.getShipMethod()}"></td>
                                <td th:text="${delivering.getOrderContent()}"></td>
                            </tr>
                        </table>
                    </div>
                </div>

                <div class="panel">
                    <div class="panel-heading">
                        <h3 class="panel-title">已完成</h3>
                    </div>
                    <div class="panel-body">
                        <table align="center">
                            <tr>
                                <td width="150px">Search Date</td>
                                <td width="350px">
                                    <form method="POST" name="SearchOrders"
                                          action="/searchOrders">

                                        <select id="selYear" name="selYear"></select>
                                        <select id="selMonth" name="selMonth"></select>
                                        <select id="selDay" name="selDay"></select>
                                        <script type="text/javascript">
                                            var selYear = window.document.getElementById("selYear");
                                            var selMonth = window.document.getElementById("selMonth");
                                            var selDay = window.document.getElementById("selDay");
                                            // 新建一个DateSelector类的实例，将三个select对象传进去
                                            var dt = new Date();
                                            new DateSelector(selYear, selMonth, selDay, dt);
                                        </script>
                                        <input type="submit" value="搜索">
                                    </form>
                                </td>
                            </tr>
                        </table>
                        <table class="table">
                            <thead>
                            <tr>
                                <th>订单ID</th>
                                <th>用户ID</th>
                                <th>收货人姓名</th>
                                <th>收货人地址</th>
                                <th>收货人电话</th>
                                <th>订单日期</th>
                                <th>订单状态</th>
                                <th>配送方法</th>
                                <th>订单项</th>
                            </tr>
                            </thead>
                            <tr th:each="finished:${finishedList}">
                                <td th:text="${finished.getOrderID()}"></td>
                                <td th:text="${finished.getCustomerID()}"></td>
                                <td th:text="${finished.receiver.getrName()}"></td>
                                <td th:text="${finished.receiver.getAddress()}"></td>
                                <td th:text="${finished.receiver.getrTel()}"></td>
                                <td th:text="${finished.getDate()}"></td>
                                <td th:text="${finished.getState()}"></td>
                                <td th:text="${finished.getShipMethod()}"></td>
                                <td th:text="${finished.getOrderContent()}"></td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

            </div>
        </div>
    </div>
</div>
</body>
</html>